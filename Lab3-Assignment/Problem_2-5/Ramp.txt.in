# Aluminum Melting Simulation Example with Pressure and Temperature Variations

units metal
dimension 3
boundary p p p

# Set up the atomic structure
lattice fcc 4.04525
region  box block 0 2 0 2 0 2 units lattice
create_box  1 box
create_atoms 1 box

# Define interatomic potential
pair_style eam/alloy
pair_coeff * * ./Al_mm.eam.fs  Al

# Set initial velocity
velocity all create 300.0 12345 mom yes rot no

# Define pressures to test (in Pa) - here we use only 0 and 5 GPa for demonstration
variable P_list string "0 100000000000"

# Temperature control variables
variable T_start equal 300.0     # Starting temperature in K
variable T_end equal 2000.0       # Ending temperature in K
variable T_step equal 25.0      # Temperature step in K

# Loop over each pressure in P_list
variable P loop ${P_list}
label pressure_loop
variable P_TARGET equal ${P}  # Set target pressure for this run

# Output settings
thermo 100
thermo_style custom step temp press vol pe ke etotal

# Print message for this pressure
print "Running simulation at Pressure: ${P_TARGET} Pa"

# Loop over temperature range
variable T equal ${T_start}
label temperature_loop

# Apply NPT ensemble with current temperature and target pressure
fix 1 all npt temp ${T} ${T} 0.1 iso ${P_TARGET} ${P_TARGET} 1.0

# Run the simulation at this temperature (adjust the run steps as needed)
run 50000

# Unfix to reset for the next temperature step
unfix 1

# Increment temperature by T_step
variable T equal ${T} + ${T_step}

# Check if temperature has reached the end, if not, repeat temperature loop
if "${T} < ${T_end}" then "jump SELF temperature_loop"

# End of temperature loop for this pressure
write_restart restart.${P_TARGET}Pa

# Move to the next pressure in the list
next P
jump SELF pressure_loop

# End of script





